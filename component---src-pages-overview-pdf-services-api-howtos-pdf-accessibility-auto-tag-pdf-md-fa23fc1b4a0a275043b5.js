"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[6296],{92695:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return l},default:function(){return m}});var a=n(87462),r=n(45987),s=(n(15007),n(64983)),i=n(91515);const o=["components"],l={},p=(u="CodeBlock",function(e){return console.warn("Component "+u+" was not imported, exported, or provided by MDXProvider as global scope"),(0,s.mdx)("div",e)});var u;const d={_frontmatter:l},g=i.Z;function m(e){let{components:t}=e,n=(0,r.Z)(e,o);return(0,s.mdx)(g,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,s.mdx)("h1",{id:"pdf-accessibility-auto-tag-api"},"PDF Accessibility Auto-Tag API"),(0,s.mdx)("h2",{id:"api-output-format"},"API Output Format"),(0,s.mdx)("p",null,"The output of the PDF Accessibility Auto-Tag API contains the following:"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"The tagged PDF file."),(0,s.mdx)("li",{parentName:"ul"},"A report in XLSX format, if the report generation was enabled. This report provides information related to the tags found in the original document, if any, and the auto-tagged document.")),(0,s.mdx)("h2",{id:"api-limitations"},"API limitations"),(0,s.mdx)("br",null),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"File size:")," Files up to a maximum of 100 MB are supported."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Number of Pages:")," Non-scanned PDFs up to 200 pages and scanned PDFs up to 100 pages are supported, however limits may be lower for files with a large number of tables."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Rate limits:")," Keep request rate below 25 requests per minute."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Page Size:")," The API supports standard page sizes not more than 17.5” or less than 6” in either dimension."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Hidden Objects:")," PDF files that contain content that is not visible on the page like JavaScript, OCG (optional content groups), etc are not supported. Files that contain such hidden information may fail to process. For such cases, ",(0,s.mdx)("a",{parentName:"li",href:"https://helpx.adobe.com/acrobat/using/removing-sensitive-content-pdfs.html"},"removing hidden content")," prior to processing files again may return a successful result."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Language:")," The API is currently optimized for English language content. Files containing content in French, German, Spanish, Danish, Dutch, Norwegian (Bokmal), Galician, Catalan, Finnish, Italian, Swedish, Portuguese, and Romanian should return good results most of the time. Files containing content in Afrikaans, Bosnian, Croatian, Czech, Hungarian, Indonesian, Malay, Polish, Russian, Serbian, Turkish, Hindi, Marathi and other similar languages should return good results often. Non-English files may have issues with non-English punctuation. OCR is configured for English content."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"OCR and Scan quality:")," The quality of text extracted from scanned files is dependent on the clarity of content in the input file and is currently configured for English content. Conditions like skewed pages, shadowing, obscured or overlapping fonts, and page resolution less than 200 DPI can all result in lower quality text output."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Form fields:")," Files containing XFA and other fillable form elements are not supported."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Unprotected files:")," The API supports files that are unprotected or where security restrictions allow editing of content. Files that are secured and do not allow editing of content will not be processed. If the password of a protected PDF is known, the permissions of the file can be modified using the PDF Services API as shown ",(0,s.mdx)("a",{parentName:"li",href:"../../pdf-services-api/howtos/remove-protection.md"},"here"),"."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Annotations:")," Content in PDF files containing annotations such as highlights and sticky notes will be processed, but annotations that obscure text could impact output quality. Text within annotations will not be included in the output."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"PDF Producers:")," The PDF Accessibility Auto-Tag API is designed to add tags to PDF to make it easier to make the file accessible. Files created from applications that produce other types of content like illustrations, CAD drawings or other types of vector art may not return high quality results."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"PDF Collections:")," PDFs that are made from a collection of files including PDF Portfolios are not currently supported.")),(0,s.mdx)("h2",{id:"error-codes"},"Error codes"),(0,s.mdx)("table",null,(0,s.mdx)("thead",{parentName:"table"},(0,s.mdx)("tr",{parentName:"thead"},(0,s.mdx)("th",{parentName:"tr",align:null},"Scenario"),(0,s.mdx)("th",{parentName:"tr",align:null},"Error code"),(0,s.mdx)("th",{parentName:"tr",align:null},"Error message"))),(0,s.mdx)("tbody",{parentName:"table"},(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Unknown error/ failure"),(0,s.mdx)("td",{parentName:"tr",align:null},"ERROR"),(0,s.mdx)("td",{parentName:"tr",align:null},"Unexpected error")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Timeout"),(0,s.mdx)("td",{parentName:"tr",align:null},"TIMEOUT"),(0,s.mdx)("td",{parentName:"tr",align:null},"Unexpected error: Processing timeout")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Disqualified"),(0,s.mdx)("td",{parentName:"tr",align:null},"DISQUALIFIED"),(0,s.mdx)("td",{parentName:"tr",align:null},"File is not suitable for conversion")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Unsupported XFA file"),(0,s.mdx)("td",{parentName:"tr",align:null},"DISQUALIFIED_XFA"),(0,s.mdx)("td",{parentName:"tr",align:null},"File is not suitable for conversion: File contains an XFA form")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Page limit violation"),(0,s.mdx)("td",{parentName:"tr",align:null},"DISQUALIFIED_PAGE_LIMIT"),(0,s.mdx)("td",{parentName:"tr",align:null},"File is not suitable for conversion: File exceeds page limit")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Scan page limit violation"),(0,s.mdx)("td",{parentName:"tr",align:null},"DISQUALIFIED_SCAN_PAGE_LIMIT"),(0,s.mdx)("td",{parentName:"tr",align:null},"File is not suitable for conversion: Scanned file exceeds page limit")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"File size violation"),(0,s.mdx)("td",{parentName:"tr",align:null},"DISQUALIFIED_FILE_SIZE"),(0,s.mdx)("td",{parentName:"tr",align:null},"File is not suitable for conversion: File exceeds size limit")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Encryption permission"),(0,s.mdx)("td",{parentName:"tr",align:null},"DISQUALIFIED_PERMISSIONS"),(0,s.mdx)("td",{parentName:"tr",align:null},"File is not suitable for conversion: File permissions do not allow conversion")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Complex file"),(0,s.mdx)("td",{parentName:"tr",align:null},"DISQUALIFIED_COMPLEX_FILE"),(0,s.mdx)("td",{parentName:"tr",align:null},"File is not suitable for conversion: File content is too complex")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Unsupported language"),(0,s.mdx)("td",{parentName:"tr",align:null},"DISQUALIFIED_LANGUAGE"),(0,s.mdx)("td",{parentName:"tr",align:null},"File is not suitable for conversion: File content language is unsupported")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Bad PDF"),(0,s.mdx)("td",{parentName:"tr",align:null},"BAD_PDF"),(0,s.mdx)("td",{parentName:"tr",align:null},"The PDF file is damaged or its content is too complex")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Bad PDF file type"),(0,s.mdx)("td",{parentName:"tr",align:null},"BAD_PDF_FILE_TYPE"),(0,s.mdx)("td",{parentName:"tr",align:null},"The input file is not a PDF file")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Damaged input file"),(0,s.mdx)("td",{parentName:"tr",align:null},"BAD_PDF_DAMAGED"),(0,s.mdx)("td",{parentName:"tr",align:null},"The input file is damaged")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Complex table"),(0,s.mdx)("td",{parentName:"tr",align:null},"BAD_PDF_COMPLEX_TABLE"),(0,s.mdx)("td",{parentName:"tr",align:null},"The input file contains a table that is too complex to process")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Complex content"),(0,s.mdx)("td",{parentName:"tr",align:null},"BAD_PDF_COMPLEX_INPUT"),(0,s.mdx)("td",{parentName:"tr",align:null},"The input file contains content that is too complex to process")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Unsupported font"),(0,s.mdx)("td",{parentName:"tr",align:null},"BAD_PDF_UNSUPPORTED_FONT"),(0,s.mdx)("td",{parentName:"tr",align:null},"The input file contains font data that is corrupted or not supported")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Large PDF file"),(0,s.mdx)("td",{parentName:"tr",align:null},"BAD_PDF_LARGE_FILE"),(0,s.mdx)("td",{parentName:"tr",align:null},"The input file size exceeds the maximum allowed")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Protected PDF"),(0,s.mdx)("td",{parentName:"tr",align:null},"PROTECTED_PDF"),(0,s.mdx)("td",{parentName:"tr",align:null},"PDF is encrypted or password-protected")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Empty or corrupted input"),(0,s.mdx)("td",{parentName:"tr",align:null},"BAD_INPUT"),(0,s.mdx)("td",{parentName:"tr",align:null},"Input is corrupted or empty")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Invalid input parameters"),(0,s.mdx)("td",{parentName:"tr",align:null},"BAD_INPUT_PARAMS"),(0,s.mdx)("td",{parentName:"tr",align:null},"Invalid input parameters")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"User not enrolled to allowed Atlas plans"),(0,s.mdx)("td",{parentName:"tr",align:null},"INVALID_PLAN_CODE"),(0,s.mdx)("td",{parentName:"tr",align:null},"Unauthorized to execute this operation. User is not enrolled to plans allowed for the service")))),(0,s.mdx)("h2",{id:"rest-api"},"REST API"),(0,s.mdx)("p",null,"See our public API Reference for ",(0,s.mdx)("a",{parentName:"p",href:"../../../apis/#tag/PDF-Accessibility-Auto-Tag"},"PDF Accessibility Auto-Tag API"),"."),(0,s.mdx)("h2",{id:"generate-tagged-pdf-from-a-pdf"},"Generate tagged PDF from a PDF"),(0,s.mdx)("p",null,"The sample below generates a tagged PDF from a PDF."),(0,s.mdx)("p",null,"Please refer to the ",(0,s.mdx)("a",{parentName:"p",href:"../api-usage.md"},"API usage guide")," to understand how to use our APIs."),(0,s.mdx)(p,{slots:"heading, code",repeat:"5",languages:"Java, .NET, Node JS, Python, REST API",mdxType:"CodeBlock"}),(0,s.mdx)("h4",{id:"java"},"Java"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-javascript"},'// Get the samples from https://github.com/adobe/pdfservices-java-sdk-samples\n// Run the sample:\n// mvn -f pom.xml exec:java -Dexec.mainClass=com.adobe.pdfservices.operation.samples.autotagpdf.AutotagPDF\n\npublic class AutotagPDF {\n    // Initialize the logger.\n    private static final Logger LOGGER = LoggerFactory.getLogger(AutotagPDF.class);\n\n    public static void main(String[] args) {\n\n        try (InputStream inputStream = Files.newInputStream(new File("src/main/resources/autotagPDFInput.pdf").toPath())) {\n            // Initial setup, create credentials instance\n            Credentials credentials = new ServicePrincipalCredentials(\n                System.getenv("PDF_SERVICES_CLIENT_ID"),\n                System.getenv("PDF_SERVICES_CLIENT_SECRET"));\n        \n            // Creates a PDF Services instance\n            PDFServices pdfServices = new PDFServices(credentials);\n        \n            // Creates an asset(s) from source file(s) and upload\n            Asset asset = pdfServices.upload(inputStream, PDFServicesMediaType.PDF.getMediaType());\n        \n            // Creates a new job instance\n            AutotagPDFJob autotagPDFJob = new AutotagPDFJob(asset);\n        \n            // Submit the job and gets the job result\n            String location = pdfServices.submit(autotagPDFJob);\n            PDFServicesResponse<AutotagPDFResult> pdfServicesResponse = pdfServices.getJobResult(location, AutotagPDFResult.class);\n        \n            // Get content from the resulting asset(s)\n            Asset resultAsset = pdfServicesResponse.getResult().getTaggedPDF();\n            StreamAsset streamAsset = pdfServices.getContent(resultAsset);\n        \n            // Creates an output stream and copy stream asset\'s content to it\n            Files.createDirectories(Paths.get("output/"));\n            OutputStream outputStream = Files.newOutputStream(new File("output/autotagPDFOutput.pdf").toPath());\n            LOGGER.info("Saving asset at output/autotagPDFOutput.pdf");\n            IOUtils.copy(streamAsset.getInputStream(), outputStream);\n            outputStream.close();\n        } catch (ServiceApiException | IOException | SDKException | ServiceUsageException ex) {\n            LOGGER.error("Exception encountered while executing operation", ex);\n        }\n    }\n')),(0,s.mdx)("h4",{id:"net"},".NET"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-javascript"},'// Get the samples from https://github.com/adobe/PDFServices.NET.SDK.Samples\n// Run the sample:\n// cd AutotagPDF/\n// dotnet run AutotagPDF.csproj\n\nnamespace AutotagPDF\n{\n    class Program\n    {\n        private static readonly ILog log = LogManager.GetLogger(typeof(Program));\n\n        static void Main()\n    {\n        //Configure the logging\n        ConfigureLogging();\n        try\n        {\n            // Initial setup, create credentials instance.\n            Credentials credentials = Credentials.ServicePrincipalCredentialsBuilder()\n                    .WithClientId("PDF_SERVICES_CLIENT_ID")\n                    .WithClientSecret("PDF_SERVICES_CLIENT_SECRET")\n                    .Build();\n\n            //Create an ExecutionContext using credentials and create a new operation instance.\n            ExecutionContext executionContext = ExecutionContext.Create(credentials);\n            AutotagPDFOperation autotagPDFOperation = AutotagPDFOperation.CreateNew();\n\n            // Provide an input FileRef for the operation\n            autotagPDFOperation.SetInput(FileRef.CreateFromLocalFile(@"autotagPDFInput.pdf"));\n\n            // Execute the operation\n            AutotagPDFOutput autotagPDFOutput = autotagPDFOperation.Execute(executionContext);\n            \n            // Save the output files at the specified location\n            autotagPDFOutput.GetTaggedPDF().SaveAs(Directory.GetCurrentDirectory() + "autotagPDFOutput.pdf");\n        }\n        catch (ServiceUsageException ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    catch (ServiceApiException ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    catch (SDKException ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    catch (IOException ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    catch (Exception ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    }\n\n        static void ConfigureLogging()\n    {\n        ILoggerRepository logRepository = LogManager.GetRepository(Assembly.GetEntryAssembly());\n        XmlConfigurator.Configure(logRepository, new FileInfo("log4net.config"));\n    }\n    }\n}\n')),(0,s.mdx)("h4",{id:"node-js"},"Node JS"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-javascript"},'// Get the samples from https://github.com/adobe/pdfservices-node-sdk-samples\n// Run the sample:\n// node src/autotagpdf/autotag-pdf.js\n\nconst {\n    ServicePrincipalCredentials,\n    PDFServices,\n    MimeType,\n    AutotagPDFJob,\n    AutotagPDFResult,\n    SDKError,\n    ServiceUsageError,\n    ServiceApiError,\n} = require("@adobe/pdfservices-node-sdk");\nconst fs = require("fs");\n\n(async () => {\n    let readStream;\n    try {\n        // Initial setup, create credentials instance\n        const credentials = new ServicePrincipalCredentials({\n            clientId: process.env.PDF_SERVICES_CLIENT_ID,\n            clientSecret: process.env.PDF_SERVICES_CLIENT_SECRET\n        });\n\n        // Creates a PDF Services instance\n        const pdfServices = new PDFServices({credentials});\n\n        // Creates an asset(s) from source file(s) and upload\n        readStream = fs.createReadStream("./autotagPDFInput.pdf");\n        const inputAsset = await pdfServices.upload({\n            readStream,\n            mimeType: MimeType.PDF\n        });\n\n        // Creates a new job instance\n        const job = new AutotagPDFJob({inputAsset});\n\n        // Submit the job and get the job result\n        const pollingURL = await pdfServices.submit({job});\n        const pdfServicesResponse = await pdfServices.getJobResult({\n            pollingURL,\n            resultType: AutotagPDFResult\n        });\n\n        // Get content from the resulting asset(s)\n        const resultAsset = pdfServicesResponse.result.taggedPDF;\n        const streamAsset = await pdfServices.getContent({asset: resultAsset});\n\n        // Creates an output stream and copy stream asset\'s content to it\n        const outputFilePath = "./autotag-tagged.pdf";\n        console.log(`Saving asset at ${outputFilePath}`);\n\n        let writeStream = fs.createWriteStream(outputFilePath);\n        streamAsset.readStream.pipe(writeStream);\n    } catch (err) {\n        if (err instanceof SDKError || err instanceof ServiceUsageError || err instanceof ServiceApiError) {\n            console.log("Exception encountered while executing operation", err);\n        } else {\n            console.log("Exception encountered while executing operation", err);\n        }\n    } finally {\n        readStream?.destroy();\n    }\n})();\n')),(0,s.mdx)("h4",{id:"python"},"Python"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-python"},"# Get the samples from https://github.com/adobe/pdfservices-python-sdk-samples\n# Run the sample:\n# python src/autotagpdf/autotag_pdf.py\n\n# Initialize the logger\nlogging.basicConfig(level=logging.INFO)\n\nclass AutoTagPDF:\n    def __init__(self):\n        try:\n            file = open('autotagPDFInput.pdf', 'rb')\n            input_stream = file.read()\n            file.close()\n\n            # Initial setup, create credentials instance\n            credentials = ServicePrincipalCredentials(\n                client_id=os.getenv('PDF_SERVICES_CLIENT_ID'),\n                client_secret=os.getenv('PDF_SERVICES_CLIENT_SECRET')\n            )\n\n            # Creates a PDF Services instance\n            pdf_services = PDFServices(credentials=credentials)\n\n            # Creates an asset(s) from source file(s) and upload\n            input_asset = pdf_services.upload(input_stream=input_stream,\n                                              mime_type=PDFServicesMediaType.PDF)\n\n            # Creates a new job instance\n            autotag_pdf_job = AutotagPDFJob(input_asset)\n\n            # Submit the job and gets the job result\n            location = pdf_services.submit(autotag_pdf_job)\n            pdf_services_response = pdf_services.get_job_result(location, AutotagPDFResult)\n\n            # Get content from the resulting asset(s)\n            result_asset: CloudAsset = pdf_services_response.get_result().get_tagged_pdf()\n            stream_asset: StreamAsset = pdf_services.get_content(result_asset)\n\n            # Creates an output stream and copy stream asset's content to it\n            output_file_path = 'autoTagPDFOutput.pdf'\n            with open(output_file_path, \"wb\") as file:\n                file.write(stream_asset.get_input_stream())\n\n        except (ServiceApiException, ServiceUsageException, SdkException) as e:\n            logging.exception(f'Exception encountered while executing operation: {e}')\n\n\nif __name__ == \"__main__\":\n    AutoTagPDF()\n\n")),(0,s.mdx)("h4",{id:"rest-api-1"},"REST API"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-javascript"},"// Please refer our REST API docs for more information \n// https://developer.adobe.com/document-services/docs/apis/#tag/PDF-Accessibility-Auto-Tag\n\ncurl --location --request POST 'https://pdf-services.adobe.io/operation/autotag' \\\n--header 'x-api-key: {{Placeholder for client_id}}' \\\n--header 'Content-Type: application/json' \\\n--header 'Authorization: Bearer {{Placeholder for token}}' \\\n--data-raw '{\n    \"assetID\": \"urn:aaid:AS:UE1:23c30ee0-2e4d-46d6-87f2-087832fca718\"\n}'\n")),(0,s.mdx)("h2",{id:"generate-tagged-pdf-by-setting-options-with-command-line-arguments"},"Generate tagged PDF by setting options with command line arguments"),(0,s.mdx)("p",null,"The sample below generates a tagged PDF by setting options through command line arguments."),(0,s.mdx)("p",null,"Here is a sample list of command line arguments and their description:"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"--input < input file path >"),(0,s.mdx)("li",{parentName:"ul"},"--output < output file path >"),(0,s.mdx)("li",{parentName:"ul"},"--report { If this argument is present then the output will be generated with the report }"),(0,s.mdx)("li",{parentName:"ul"},"--shift_headings { If this argument is present then the headings will be shifted in the output PDF file }")),(0,s.mdx)(p,{slots:"heading, code",repeat:"4",languages:"Java, .NET, Node JS, Python",mdxType:"CodeBlock"}),(0,s.mdx)("h4",{id:"java-1"},"Java"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-javascript"},'// Get the samples from https://github.com/adobe/pdfservices-java-sdk-samples\n// Run the sample:\n// mvn -f pom.xml exec:java -Dexec.mainClass=com.adobe.pdfservices.operation.samples.autotagpdf.AutotagPDFParamaterised\n\npublic class AutotagPDFParameterised {\n\n    private static final org.slf4j.Logger LOGGER = LoggerFactory.getLogger(AutotagPDFParameterised.class);\n\n    public static void main(String[] args) {\n        LOGGER.info("--input " + getInputFilePathFromCmdArgs(args));\n        LOGGER.info("--output " + getOutputFilePathFromCmdArgs(args));\n        LOGGER.info("--report " + getGenerateReportFromCmdArgs(args));\n        LOGGER.info("--shift_headings " + getShiftHeadingsFromCmdArgs(args));\n        \n        try (InputStream inputStream = Files.newInputStream(new File(getInputFilePathFromCmdArgs(args)).toPath())) {\n            // Initial setup, create credentials instance\n            Credentials credentials = new ServicePrincipalCredentials(\n                System.getenv("PDF_SERVICES_CLIENT_ID"),\n                System.getenv("PDF_SERVICES_CLIENT_SECRET"));\n        \n            // Creates a PDF Services instance\n            PDFServices pdfServices = new PDFServices(credentials);\n        \n            // Creates an asset(s) from source file(s) and upload\n            Asset asset = pdfServices.upload(inputStream, PDFServicesMediaType.PDF.getMediaType());\n        \n            // Create parameters for the job\n            AutotagPDFParams autotagPDFParams = getOptionsFromCmdArgs(args);\n        \n            // Creates a new job instance\n            AutotagPDFJob autotagPDFJob = new AutotagPDFJob(asset)\n                .setParams(autotagPDFParams);\n        \n            // Submit the job and gets the job result\n            String location = pdfServices.submit(autotagPDFJob);\n            PDFServicesResponse<AutotagPDFResult> pdfServicesResponse = pdfServices.getJobResult(location, AutotagPDFResult.class);\n        \n            // Get content from the resulting asset(s)\n            Asset resultAsset = pdfServicesResponse.getResult().getTaggedPDF();\n            Asset resultAssetReport = pdfServicesResponse.getResult().getReport();\n            StreamAsset streamAsset = pdfServices.getContent(resultAsset);\n            StreamAsset streamAssetReport = (autotagPDFParams != null && autotagPDFParams.isGenerateReport()) ?\n                pdfServices.getContent(resultAssetReport) : null;\n        \n            // Creating output streams and copying stream assets\' content to it\n            Files.createDirectories(Paths.get("output/"));\n            String outputPath = getOutputFilePathFromCmdArgs(args);\n            OutputStream outputStream = Files.newOutputStream(new File(outputPath + "autotagPDFInput-tagged.pdf").toPath());\n            LOGGER.info("Saving asset at " + outputPath + "autotagPDFInput-tagged.pdf");\n            IOUtils.copy(streamAsset.getInputStream(), outputStream);\n            if(streamAssetReport != null) {\n                OutputStream outputStreamReport = Files.newOutputStream(new File(outputPath + "autotagPDFInput-report.xlsx").toPath());\n                LOGGER.info("Saving asset at " + outputPath + "autotagPDFInput-report.xlsx");\n                IOUtils.copy(streamAssetReport.getInputStream(), outputStreamReport);\n                outputStreamReport.close();\n            }\n        } catch (ServiceApiException | IOException | SDKException | ServiceUsageException e) {\n            LOGGER.error("Exception encountered while executing operation", e);\n        }\n    }\n\n    private static AutotagPDFParams getOptionsFromCmdArgs(String[] args) {\n        Boolean generateReport = getGenerateReportFromCmdArgs(args);\n        Boolean shiftHeadings = getShiftHeadingsFromCmdArgs(args);\n        AutotagPDFParams.Builder autotagPDFParamsBuilder = AutotagPDFParams.autotagPDFParamsBuilder();\n    \n        if (generateReport)\n            autotagPDFParamsBuilder.generateReport();\n        if (shiftHeadings)\n            autotagPDFParamsBuilder.shiftHeadings();\n    \n        return autotagPDFParamsBuilder.build();\n    }\n    \n    private static Boolean getShiftHeadingsFromCmdArgs(String[] args) {\n        return Arrays.asList(args).contains("--shift_headings");\n    }\n    \n    private static Boolean getGenerateReportFromCmdArgs(String[] args) {\n        return Arrays.asList(args).contains("--report");\n    }\n    \n    private static String getInputFilePathFromCmdArgs(String[] args) {\n        String inputFilePath = "src/main/resources/autotagPDFInput.pdf";\n        int inputFilePathIndex = Arrays.asList(args).indexOf("--input");\n        if (inputFilePathIndex >= 0 && inputFilePathIndex < args.length - 1) {\n            inputFilePath = args[inputFilePathIndex + 1];\n        } else\n            LOGGER.info("input file not specified, using default value : autotagPDFInput.pdf");\n    \n        return inputFilePath;\n    }\n    \n    private static String getOutputFilePathFromCmdArgs(String[] args) {\n        String outputFilePath = "output/AutotagPDFParameterised/";\n        int outputFilePathIndex = Arrays.asList(args).indexOf("--output");\n        if (outputFilePathIndex >= 0 && outputFilePathIndex < args.length - 1) {\n            outputFilePath = args[outputFilePathIndex + 1];\n        } else\n            LOGGER.info("output path not specified, using default value : " + outputFilePath);\n    \n        return outputFilePath;\n    }\n}\n\n')),(0,s.mdx)("h3",{id:"net-1"},".NET"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-javascript"},'\n// Get the samples from https://github.com/adobe/PDFServices.NET.SDK.Samples\n// Run the sample:\n// cd AutotagPDF/\n// dotnet run .csproj\n\nnamespace AutotagPDFParameterised\n{\n    class Program\n    {\n        private static readonly ILog log = LogManager.GetLogger(typeof(Program));\n\n        private static AutotagPDFOptions GetOptionsFromCmdArgs(String[] args)\n    {\n        Boolean generateReport = GetGenerateReportFromCmdArgs(args);\n        Boolean shiftHeadings = GetShiftHeadingsFromCmdArgs(args);\n\n        AutotagPDFOptions.Builder builder = AutotagPDFOptions.AutotagPDFOptionsBuilder();\n\n        if (generateReport) builder.GenerateReport();\n        if (shiftHeadings) builder.ShiftHeadings();\n\n        return builder.Build();\n    }\n\n    private static Boolean GetShiftHeadingsFromCmdArgs(String[] args)\n    {\n        return Array.Exists(args, element => element == "--shift_headings");\n    }\n\n    private static Boolean GetGenerateReportFromCmdArgs(String[] args)\n    {\n        return Array.Exists(args, element => element == "--report");\n    }\n\n    private static String GetInputFilePathFromCmdArgs(String[] args)\n    {\n        String inputFilePath = @"autotagPdfInput.pdf";\n        int inputFilePathIndex = Array.IndexOf(args, "--input");\n        if (inputFilePathIndex >= 0 && inputFilePathIndex < args.Length - 1)\n        {\n            inputFilePath = args[inputFilePathIndex + 1];\n        }\n        else\n            log.Info("input file not specified, using default value : autotagPdfInput.pdf");\n\n        return inputFilePath;\n    }\n\n    private static String GetOutputFilePathFromCmdArgs(String[] args)\n    {\n        String outputFilePath = Directory.GetCurrentDirectory() + "/output/";\n        int outputFilePathIndex = Array.IndexOf(args, "--output");\n        if (outputFilePathIndex >= 0 && outputFilePathIndex < args.Length - 1)\n        {\n            outputFilePath = args[outputFilePathIndex + 1];\n        }\n        else\n            log.Info("output path not specified, using default value : /output/");\n\n        return outputFilePath;\n    }\n\n    static void Main(string[] args)\n    {\n        //Configure the logging\n        ConfigureLogging();\n\n        log.Info("--input " + GetInputFilePathFromCmdArgs(args));\n        log.Info("--output " + GetOutputFilePathFromCmdArgs(args));\n        log.Info("--report " + GetGenerateReportFromCmdArgs(args));\n        log.Info("--shift_headings " + GetShiftHeadingsFromCmdArgs(args));\n\n        try\n        {\n            // Initial setup, create credentials instance.\n            Credentials credentials = Credentials.ServicePrincipalCredentialsBuilder()\n                    .WithClientId("PDF_SERVICES_CLIENT_ID")\n                    .WithClientSecret("PDF_SERVICES_CLIENT_SECRET")\n                    .Build();\n\n            //Create an ExecutionContext using credentials and create a new operation instance.\n            ExecutionContext executionContext = ExecutionContext.Create(credentials);\n            AutotagPDFOperation autotagPDFOperation = AutotagPDFOperation.CreateNew();\n\n            // Provide an input FileRef for the operation\n            autotagPDFOperation.SetInput(FileRef.CreateFromLocalFile(GetInputFilePathFromCmdArgs(args)));\n\n            // Get and Build AutotagPDF options from command line args and set them into the operation\n            AutotagPDFOptions autotagPDFOptions = GetOptionsFromCmdArgs(args);\n            autotagPDFOperation.SetOptions(autotagPDFOptions);\n\n            // Execute the operation\n            AutotagPDFOutput autotagPDFOutput = autotagPDFOperation.Execute(executionContext);\n\n            // Save the output files at the specified location\n            string outputPath = GetOutputFilePathFromCmdArgs(args);\n            FileRef taggedPDF = autotagPDFOutput.GetTaggedPDF();\n            taggedPDF.SaveAs(Directory.GetCurrentDirectory() + outputPath + "autotagPDFInput-tagged.pdf");\n            if (autotagPDFOptions != null && autotagPDFOptions.IsGenerateReport)\n                autotagPDFOutput.GetReport()\n                    .SaveAs(Directory.GetCurrentDirectory() + outputPath + "autotagPDFInput-report.xlsx");\n        }\n        catch (ServiceUsageException ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    catch (ServiceApiException ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    catch (SDKException ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    catch (IOException ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    catch (Exception ex)\n        {\n            log.Error("Exception encountered while executing operation", ex);\n        }\n    }\n\n    static void ConfigureLogging()\n    {\n        ILoggerRepository logRepository = LogManager.GetRepository(Assembly.GetEntryAssembly());\n        XmlConfigurator.Configure(logRepository, new FileInfo("log4net.config"));\n    }\n}\n}\n')),(0,s.mdx)("h4",{id:"node-js-1"},"Node JS"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-javascript"},'// Get the samples from https://github.com/adobe/pdfservices-node-sdk-samples\n// Run the sample:\n// node src/autotag/autoag-pdf-parameterised.js\n\nconst {\n    ServicePrincipalCredentials,\n    PDFServices,\n    MimeType,\n    AutotagPDFParams,\n    AutotagPDFJob,\n    AutotagPDFResult,\n    SDKError,\n    ServiceUsageError,\n    ServiceApiError\n} = require("@adobe/pdfservices-node-sdk");\nconst fs = require("fs");\nconst args = process.argv;\n\n(async () => {\n    let readStream;\n    try {\n        console.log("--input " + getInputFilePathFromCmdArgs(args));\n        console.log("--output " + getOutputFilePathFromCmdArgs(args));\n        console.log("--report " + getGenerateReportFromCmdArgs(args));\n        console.log("--shift_headings " + getShiftHeadingsFromCmdArgs(args));\n\n        // Initial setup, create credentials instance\n        const credentials = new ServicePrincipalCredentials({\n            clientId: process.env.PDF_SERVICES_CLIENT_ID,\n            clientSecret: process.env.PDF_SERVICES_CLIENT_SECRET\n        });\n\n        // Creates a PDF Services instance\n        const pdfServices = new PDFServices({credentials});\n\n        // Creates an asset(s) from source file(s) and upload\n        readStream = fs.createReadStream(getInputFilePathFromCmdArgs(args));\n        const inputAsset = await pdfServices.upload({\n            readStream,\n            mimeType: MimeType.PDF\n        });\n\n        // Create parameters for the job\n        const params = new AutotagPDFParams({\n            generateReport: getGenerateReportFromCmdArgs(args),\n            shiftHeadings: getShiftHeadingsFromCmdArgs(args)\n        });\n\n        // Creates a new job instance\n        const job = new AutotagPDFJob({inputAsset, params});\n\n        // Submit the job and get the job result\n        const pollingURL = await pdfServices.submit({job});\n        const pdfServicesResponse = await pdfServices.getJobResult({\n            pollingURL,\n            resultType: AutotagPDFResult\n        });\n\n        // Get content from the resulting asset(s)\n        const resultAsset = pdfServicesResponse.result.taggedPDF;\n        const resultAssetReport = pdfServicesResponse.result.report;\n        const streamAsset = await pdfServices.getContent({asset: resultAsset});\n        const streamAssetReport = resultAssetReport\n            ? await pdfServices.getContent({asset: resultAssetReport})\n            : undefined;\n\n        // Creates an output stream and copy stream asset\'s content to it\n        const outputPath = getOutputFilePathFromCmdArgs(args);\n        const outputFilePath = outputPath + "autotagPDFInput-tagged.pdf";\n        console.log(`Saving asset at ${outputFilePath}`);\n\n        const writeStream = fs.createWriteStream(outputFilePath);\n        streamAsset.readStream.pipe(writeStream);\n        if (resultAssetReport) {\n            const outputFileReportPath = outputPath + "autotagPDFInput-report.xlsx";\n            console.log(`Saving asset at ${outputFileReportPath}`);\n\n            const writeStream = fs.createWriteStream(outputFileReportPath);\n            streamAssetReport.readStream.pipe(writeStream);\n        }\n    } catch (err) {\n        if (err instanceof SDKError || err instanceof ServiceUsageError || err instanceof ServiceApiError) {\n            console.log("Exception encountered while executing operation", err);\n        } else {\n            console.log("Exception encountered while executing operation", err);\n        }\n    } finally {\n        readStream?.destroy();\n    }\n})();\n\nfunction getInputFilePathFromCmdArgs(args) {\n    let inputFilePath = "resources/autotagPdfInput.pdf";\n    let inputFilePathIndex = args.indexOf("--input");\n    if (inputFilePathIndex >= 0 && inputFilePathIndex < args.length - 1) {\n        inputFilePath = args[inputFilePathIndex + 1];\n    } else\n        console.log("input file not specified, using default value : autotagPdfInput.pdf");\n    return inputFilePath;\n}\n\nfunction getOutputFilePathFromCmdArgs(args) {\n    let outputFilePath = "output/";\n    let outputFilePathIndex = args.indexOf("--output");\n    if (outputFilePathIndex >= 0 && outputFilePathIndex < args.length - 1) {\n        outputFilePath = args[outputFilePathIndex + 1];\n    } else {\n        console.log("output path not specified, using default value :" + outputFilePath);\n        fs.mkdirSync(outputFilePath, {recursive: true});\n    }\n    return outputFilePath;\n}\n\nfunction getGenerateReportFromCmdArgs(args) {\n    return args.includes("--report");\n}\n\nfunction getShiftHeadingsFromCmdArgs(args) {\n    return args.includes("--shift_headings");\n}\n')),(0,s.mdx)("h4",{id:"python-1"},"Python"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-python"},"# Get the samples from https://github.com/adobe/pdfservices-python-sdk-samples\n# Run the sample:\n# python src/autotagpdf/autotag_pdf_parameterised.py --report --shift_headings --input resources/autotagPdfInput.pdf --output output/\n\n# Initialize the logger\nlogging.basicConfig(level=logging.INFO)\n\nclass AutotagPDFParameterised:\n    _input_path: str\n    _output_path: str\n    _generate_report: bool\n    _shift_headings: bool\n\n    def __init__(self):\n        pass\n\n    def execute(self, *args: str) -> None:\n        args = self.parse_args(*args)\n        self._input_path = args.input if args.input else self.get_default_input_file_path()\n        self._output_path = args.output if args.output else self.get_default_output_file_path()\n        self._generate_report = args.report\n        self._shift_headings = args.shift_headings\n\n        self.autotag_pdf()\n\n    def autotag_pdf(self):\n        try:\n            file = open(self._input_path, 'rb')\n            input_stream = file.read()\n            file.close()\n\n            # Initial setup, create credentials instance\n            credentials = ServicePrincipalCredentials(\n                client_id=os.getenv('PDF_SERVICES_CLIENT_ID'),\n                client_secret=os.getenv('PDF_SERVICES_CLIENT_SECRET')\n            )\n\n            # Creates a PDF Services instance\n            pdf_services = PDFServices(credentials=credentials)\n\n            # Creates an asset(s) from source file(s) and upload\n            input_asset = pdf_services.upload(input_stream=input_stream,\n                                              mime_type=PDFServicesMediaType.PDF)\n\n            # Create parameters for the job\n            autotag_pdf_params = self.get_autotag_pdf_options()\n\n            # Creates a new job instance\n            autotag_pdf_job = AutotagPDFJob(input_asset=input_asset,\n                                            autotag_pdf_params=autotag_pdf_params)\n\n            # Submit the job and gets the job result\n            location = pdf_services.submit(autotag_pdf_job)\n            pdf_services_response = pdf_services.get_job_result(location, AutotagPDFResult)\n\n            # Get content from the resulting asset(s)\n            result_asset: CloudAsset = pdf_services_response.get_result().get_tagged_pdf()\n            stream_asset: StreamAsset = pdf_services.get_content(result_asset)\n\n            # Create output directory if not present\n            self.create_output_file_path(self._output_path)\n\n            # Creates an output stream and copy stream asset's content to it\n            with open(f'{self._output_path}/autotagPDFInput-tagged.pdf', \"wb\") as file:\n                file.write(stream_asset.get_input_stream())\n\n            if self._generate_report:\n                result_asset_report: CloudAsset = pdf_services_response.get_result().get_report()\n                stream_asset_report: StreamAsset = pdf_services.get_content(result_asset_report)\n                with open(f'{self._output_path}/autotagPDFInput-report.xlsx', \"wb\") as file:\n                    file.write(stream_asset_report.get_input_stream())\n\n        except (ServiceApiException, ServiceUsageException, SdkException) as e:\n            logging.exception(f'Exception encountered while executing operation: {e}')\n\n    @staticmethod\n    def parse_args(*args: str):\n        if not args:\n            args = sys.argv[1:]\n        parser = argparse.ArgumentParser(description='Autotag PDF')\n\n        parser.add_argument('--input', help='Input file path', type=Path, metavar='input')\n        parser.add_argument('--output', help='Output path', type=Path, dest='output')\n        parser.add_argument('--report', dest='report', action='store_true', help='Generate report(in XLSX format)',\n                            default=False)\n        parser.add_argument('--shift_headings', dest='shift_headings', action='store_true', help='Shift headings',\n                            default=False)\n\n        return parser.parse_args(args)\n\n    @staticmethod\n    def get_default_input_file_path() -> str:\n        return 'autotagPdfInput.pdf'\n\n    @staticmethod\n    def get_default_output_file_path() -> str:\n        now = datetime.now()\n        time_stamp = now.strftime(\"%Y-%m-%dT%H-%M-%S\")\n        os.makedirs(\"output/AutotagPDFParameterised\", exist_ok=True)\n        return f\"output/AutotagPDFParameterised/autotag-tagged{time_stamp}\"\n\n    @staticmethod\n    def create_output_file_path(path) -> None:\n        os.makedirs(path, exist_ok=True)\n\n    def get_autotag_pdf_options(self) -> AutotagPDFParams:\n        return AutotagPDFParams(\n            shift_headings=self._shift_headings,\n            generate_report=self._generate_report\n        )\n\n\nif __name__ == \"__main__\":\n    autotag_pdf_parameterised = AutotagPDFParameterised()\n    autotag_pdf_parameterised.execute()\n")))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-overview-pdf-services-api-howtos-pdf-accessibility-auto-tag-pdf-md-fa23fc1b4a0a275043b5.js.map